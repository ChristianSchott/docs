<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>FFCanvas - Fluid Flow</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../faq.html"><strong aria-hidden="true">1.1.</strong> Frequently Asked Questions</a></li><li class="chapter-item expanded "><a href="../getting_started.html"><strong aria-hidden="true">1.2.</strong> Getting Started</a></li></ol></li><li class="chapter-item expanded "><a href="../drawing.html"><strong aria-hidden="true">2.</strong> Drawing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../drawing_decal.html"><strong aria-hidden="true">2.1.</strong> FFDecal</a></li><li class="chapter-item expanded "><a href="../drawing_brush.html"><strong aria-hidden="true">2.2.</strong> FFBrush</a></li></ol></li><li class="chapter-item expanded "><a href="../custom_shaders.html"><strong aria-hidden="true">3.</strong> Custom Shaders</a></li><li class="chapter-item expanded affix "><li class="part-title">Components</li><li class="chapter-item expanded "><a href="../components/ffcanvas.html" class="active"><strong aria-hidden="true">4.</strong> FFCanvas</a></li><li class="chapter-item expanded "><a href="../components/ffgravitymap.html"><strong aria-hidden="true">5.</strong> FFGravityMap</a></li><li class="chapter-item expanded "><a href="../components/ffsimulator.html"><strong aria-hidden="true">6.</strong> FFSimulator</a></li><li class="chapter-item expanded "><a href="../components/ffsimulatorparticles.html"><strong aria-hidden="true">7.</strong> FFSimulatorParticle</a></li><li class="chapter-item expanded "><a href="../components/ffeffects.html"><strong aria-hidden="true">8.</strong> FFEffects</a></li><li class="chapter-item expanded "><a href="../components/ffseamfixer.html"><strong aria-hidden="true">9.</strong> FFSeamFixer</a></li><li class="chapter-item expanded affix "><li class="part-title">ScriptableObjects</li><li class="chapter-item expanded "><a href="../scriptable_objects/ffmodelcache.html"><strong aria-hidden="true">10.</strong> FFModelCache</a></li><li class="chapter-item expanded "><a href="../scriptable_objects/texture_channel.html"><strong aria-hidden="true">11.</strong> Texture Channel</a></li><li class="chapter-item expanded "><a href="../scriptable_objects/texture_channel_format.html"><strong aria-hidden="true">12.</strong> Texture Channel Format</a></li><li class="chapter-item expanded affix "><a href="../contact.html">Contact</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Fluid Flow</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ffcanvas"><a class="header" href="#ffcanvas">FFCanvas</a></h1>
<p>The <code>FFCanvas</code> is the main component of FluidFlow.
It manages the RenderTextures used for drawing, and sets up the renderers' materials for displaying the textures.</p>
<p>In order for the drawing to work properly each mesh, that is being drawn on, requires a bijective UV map, meaning that there is a 1-to-1 mapping between the object's surface and its texture coordinates.
Consequently, the UV islands must not overlap, and there should be at least a 2 pixel-wide gap between UV islands for the fluid simulation to work properly.</p>
<p>If a models primary UV map does not fulfill these requirements, the secondary/lightmap UVs can be used instead.
Unity can automatically generate such a secondary lightmap UVs, by enabling the <code>Generate Lightmap UVs</code> option, in the models import settings.
However, it has to be noted that the 'quality' of automatically generated lightmap UVs is lower than a set of handcrafted UVs, as UV seams might be in very prominent places of the model.
FluidFlow can deal with UV seams (see <code>FFEffects</code>/<code>FFSeamFixer</code>), but it is impossible to completely hide all artifacts from UV seams.
Especially for fluid simulations, UV seams can be noticeable, as fluid has to be teleported between UV islands, and texel density will most likely change at the seam.</p>
<h3 id="fields"><a class="header" href="#fields">Fields</a></h3>
<ul>
<li><strong>Auto Initialize</strong>: initialize the <code>FFCanvas</code> automatically <code>OnStart()</code>.</li>
<li><strong>Initialize Async</strong>: don't block the main thread if pre-processing of the meshes is requied. Check out <a href="../scriptable_object/ffmodelcache.html">FFModelCache</a> for faster initialization. </li>
</ul>
<h2 id="surfaces"><a class="header" href="#surfaces">Surfaces</a></h2>
<p>The internal textures of a <code>FFCanvas</code> can be shared by multiple renderers and submeshes of these renderers.
For each renderer in the <code>Surfaces</code> list, you can define which UV-set should be used for drawing.
Additionally, you can define which subset of submeshes of the renderer is included in the <code>FFCanvas</code>, and define the section of the texture atlas the surface should occupy using the <code>UV Scale</code> and <code>UV Offset</code> properties.
Optionally, you can assign different section for different sets of submeshes.
In general, no UV-island should overlap any other UV-island, even of other submeshes/renderers.</p>
<p>Click the <code>Open In Editor</code> button, for a visual editor for simpler layouting of the uv maps.</p>
<h2 id="texture-channels"><a class="header" href="#texture-channels">Texture Channels</a></h2>
<p>Each <strong>Texture Channel</strong> is internally represented by a <a href="https://docs.unity3d.com/ScriptReference/RenderTexture.html">RenderTexure</a>, and is directly (reference) or indirectly (name) identified using a <a href="../scriptable_objects/texture_channel.html"><code>TextureChannel</code></a> object.
The <code>TextureChannel</code> also defines to which texture property of the <strong>Surfaces'</strong> materials the <code>RenderTexture</code> is applied to.</p>
<p>The format of the internal <code>RenderTexture</code> is determined using a <a href="../scriptable_objects/texture_channel_format.html"><code>TextureChannelFormat</code></a> object.</p>
<p>It is either initialized with a solid color, or by copying the contents of the current textures assigned to the renderers' materials.</p>
<p>When the texture channels are initialized, they are assigned corresponding texture properties of the renderers using <a href="https://docs.unity3d.com/ScriptReference/MaterialPropertyBlock.html"><code>MaterialPropertyBlocks</code></a>.
So do not be confused, if the textures do not show up in the material's inspector fields, as they are directly assigned to the renderers.</p>
<h2 id="material-property-overrides"><a class="header" href="#material-property-overrides">Material Property Overrides</a></h2>
<p>The <strong>Material Property Overrides</strong> define to which material properties the <code>UV Scale</code>, <code>UV Offset</code>, and selected UV set information is passed.</p>
<ul>
<li>
<p><strong>Atlas Transform Propety</strong>: refers to a <code>float4</code> property encoded as (<code>UV_Scale</code>.xy, <code>UV_Offset</code>.xy). This is the same format as used for Unity's default texture tiling and offset property, accessed via the <code>_ST</code> postfix in the shader (e.g. <code>_MainTex_ST</code>).</p>
</li>
<li>
<p><strong>Secondary UV Name</strong>: is either set as a keyword, if the secondary UV set is used, or a <code>float</code> property with the given name is set to <code>0</code>/<code>1</code>, depending on the UV set used.</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../custom_shaders.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../components/ffgravitymap.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../custom_shaders.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../components/ffgravitymap.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
